
Алгоритм Бойера-Мура со сдвигом по стоп-символам

**Шаг 1**

Прикладываем левый край образца к левому краю текста, К = 0

Заполняем таблицу сдвигов по стоп-символам d

**Шаг 2**

Проверяем, входит ли образец в текст, начиная с К-й позиции, последовательным сравнением символов образца q[j] с символами текста s[K+j] справа налево, j=M-1...0

**Шаг 3**

Если имеем M совпадений, то образец в тексте найден – конец работы

Если K+M >= N, то образец в тексте не найден – конец работы

Иначе K = K+d[s[K+M-1]] и переходим к шагу 2

Псевдокод.

![](https://lh5.googleusercontent.com/_sj-vOEjzqzvFLfMuya6oM8bV6-zLwhYYStd9w6Phk60KQ4TNwE42-NeEg6QuwCWqhgTf6GO2v4p7_lB5jx-B6IyXFIKr8bBtN4svjbH4QDGohRVt2TeTIFmPSK3f2xgqU1iQytXiWun6G5i5y91okc)

  
  
  

**Заполнение таблицы сдвигов по стоп-символам**

- Для каждого символа x из образца

- Если q[M-1] != х (не последний символ), то d[x] есть расстояние от последнего вхождения х в образец до q[M-1]

- Если q[M-1] == х (последний символ) и x входит в образец >= 2 раз, то d[x] равно расстоянию от предпоследнего вхождения х до q[M-1]

- Если q[M-1] == х (последний символ) и x входит в образец 1 раз, то d[x] = М
