**Поиск кратчайшего пути в графе**
**Формулировка задачи**:
	Дан ориентированный или неориентированный граф G со взвешенными рёбрами. Длиной пути назовём сумму весов рёбер, входящих в этот путь. Требуется найти кратчайшие пути от выделенной вершины s до всех вершин графа.

В графе не должно быть отрицательных циклов, достижимых из s.

##### Алгоритма Флойда

Алгоритм Флойда использует матрицу A(n×n), в которой находятся длины кратчайших путей. В начале:

Aij = wij , если i ≠ j и (i,j) из E; 

Aij = 0, если i = j; 

Aij = ∞, если i ≠ j и (i,j) не из E.

Над матрицей A выполняется n итераций. После k-й итерации Aij содержит значение наименьшей длины пути из вершины i в вершину j, причём путь проходит только через вершины с номерами, не большими k.

Вычисление на k-ой итерации выполняется по формуле:

Aijk=min(Aijk-1, Aikk-1+Akjk-1)

Верхний индекс k обозначает значение матрицы A после k-ой итерации.

Для вычисления Aijk производится сравнение величины Aijk-1 (т.е. длина пути от вершины i до вершины j без участия вершины k или другой вершины с более высоким номером) с величиной Aikk-1+Akjk-1 (длина пути от вершины i до вершины k плюс длина пути от вершины k до вершины j). Если путь через вершину k короче, то величина Aijk изменяется.

  

Пример.

![](https://lh5.googleusercontent.com/lCr69wqVBCJwQmoJglJNKoFoe6b1caeK7BlAObTJqMPTRUp5td1lXy1sqa8Pj06iOncnLLVUkue9DuQYu7s7NTZBG4ImNiNBAu9np3PfiAVVL9Kvbymqor8V8C1n1jXc66w70hqHaredd1DSkK2Fwt0)

  

![](https://lh4.googleusercontent.com/PwH-ewnXg4M-Rs6RxCBdyK5sZPpoZNm_YudxrHJUSbRtelWh7no0lYpPoazdBhNEqEHX5G3RFbyIXzkKQB3tregvGk8hoaRDKtZ7dOpGtfFYQUQjk33bJ4Tm_dCdFm__AtNreLkRFF381nJfvaX7Wqg)

**