**- Дана последовательность матриц A1,A2,…,An

- Требуется минимизировать количество скалярных операция для вычисления их произведения
- Матрицы совместимы, т.е. количество столбцов Ai-1 равно количеству строк Ai


  

- Для вычисления произведения двух матриц k на m и m на n требуется kmn умножений

- Умножение матриц ассоциативно – (A1A2)A3 = A1(A2A3)

- Например, если размеры матриц 10x100, 100x10 и 10x1, то в первом случае нам потребуется 10000+100=10100 умножений, а во втором случае 1000+1000 = 2000 умножений. Разница может быть существенной

- Можно решать перебором, но количество вариантов экспоненциально. Слишком долго
 
- Воспользуемся динамическим программированием


- Пусть даны n матриц **A**<sub>1</sub>: p<sub>0</sub>* p<sub>1</sub>, **A**<sub>2</sub>: p<sub>1</sub>* p<sub>2</sub>, …, **A**<sub>n</sub>: p<sub>n-1</sub>* p<sub>n</sub>

- Обозначим A<sub>i..j</sub>=A<sub>i</sub>A<sub>i+1</sub>…A<sub>j</sub>, i<=j

- При i < j можно разбить A<sub>i..j</sub> на 2 произведения (расставить скобки) – A<sub>i..k</sub> и A<sub>k+1..j</sub>

- Обозначим через m[i,j] – минимальное количество скалярных операций для вычисления A<sub>i..j</sub>.
**Тогда**: 
- ![](https://lh6.googleusercontent.com/HbQVLMTyLiBE1Pliw4ojRb3jFAl7-YuUt19opc9oYWI9hgj6GcK3n4ZqqFkPsBgW4Qf-V5Kn5NnAhmWZbNL7B1WLGxU-WyTiy67wMf5NuCx4P8hd1iFlvtrIKNhpvQu2FiKQ-7dzFtYvD5Z19f9Oojo)